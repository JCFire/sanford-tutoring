define("formCommon/bi/errors.json",[],function(){return{FORM_SUBMIT_FAILURE:{errorCode:101027,severity:"error",params:{p1:"componentId",p2:"componentType",p3:"errorDesc",p4:"response"}},FORM_SUBMIT_FINAL_FALLBACK:{errorCode:101028,severity:"fatal",params:{p1:"componentId",p2:"componentType",p3:"errorDesc",p4:"response"}},FORM_SUBMIT_INVALID_EMAIL:{errorCode:101029,severity:"error",params:{p1:"email"}}}});define("formCommon/bi/errors",["formCommon/bi/errors.json","lodash","utils"],function(a,b,c){"use strict";b.forEach(a,function(a,b){a.errorName=b});c.logger.register("forms","error",a);return a});define("formCommon/bi/events.json",[],function(){return{FORM_SUBMIT:{eventId:100,adapter:"ugc-viewer",params:{c1:"componentId",c2:"componentType"}},FORM_SUBMIT_SUCCESS:{eventId:367,adapter:"ugc-viewer",params:{component_id:"componentId",component_type:"componentType"}}}});define("formCommon/bi/events",["formCommon/bi/events.json","utils"],function(a,b){"use strict";b.logger.register("components","event",a);return a});define("formCommon/mixins/formMixin",["lodash","santaProps","core","utils","formCommon/bi/errors","formCommon/bi/events","experiment","reactDOM","react"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=c.compMixins,k=d.cookieUtils,l=d.dateTimeUtils,m=d.ajaxLibrary;var n="wixClient";function o(a,b,c,d,e,f,h,i,j,k){if(g.isOpen("sendContactFormEmailsViaPong")){return{metaSiteId:f||"dc853130-4fb2-464f-878d-3b6667dc4f97",to:[{address:c,name:c}],bcc:d?{address:d,name:d}:null,from:{address:a,name:b},contactPhone:i,contactAddress:k,formSubject:j,formMessage:h}}return{to:[{address:c,personal:c}],bcc:d?[{address:d||"n/a",personal:d||"n/a"}]:[],cc:[],from:{address:a,personal:b},subject:e,metaSiteId:f||"dc853130-4fb2-464f-878d-3b6667dc4f97",plainTextMessage:"n/a"}}function p(b,c,d){var e=new Date,f={todayDate:"<%=todayDay%> <%=todayMonthName%>, <%=todayYear%>",singleField:'<li style="list-style: none; margin: 0 0 5px 0; padding: 0;"><b><%=fieldKey%></b> <%=fieldValue%></li>',outerMessage:'<ul style="list-style: none; margin: 0; padding: 0;">'+'<li style="list-style: none; margin: 0 0 5px 0; padding: 0;"><b><%=title%></b></li>'+'<li style="list-style: none; margin: 0 0 15px 0; padding: 0;"><%=via%> <%=websiteUrl%></li>'+'<li style="list-style: none; margin: 0 0 5px 0; padding: 0;"><b><%=details%></b></li>'+'<li style="list-style: none; margin: 0 0 25px 0; padding: 0;">'+'<ul style="margin: 0 0 0 20px; padding: 0;"><%=fields%></ul></li>'+'<li style="list-style: none; margin: 0 0 15px 0; padding: 0;"><b><%=sentOn%></b> <%=dateToday%></li>'+'<li style="list-style: none; margin: 0; padding: 0;"><%=thanks%></li></ul>'};return a.template(f.outerMessage)({title:this.translatedKeys.title,via:this.translatedKeys.via,websiteUrl:c,details:this.translatedKeys.details,fields:a.reduce(b,function(b,c,d){return b+a.template(f.singleField)({fieldKey:d,fieldValue:c})},""),sentOn:this.translatedKeys.sentOn,dateToday:a.template(f.todayDate)({todayDay:e.getDate(),todayMonthName:l.getMonthName(e.getMonth()),todayYear:e.getFullYear()}),thanks:this.translatedKeys["thanks"+(d?"_premium":"")]})}function q(){var a=this.getFormFields.call(this),b=this.props.isPremiumUser,c=o(this.state.email.value,this.getInputName(),this.props.compData.toEmailAddress,this.props.compData.bccEmailAddress,this.translatedKeys["subject"+(b?"_premium":"")]+" "+(a.email||a.Email||a[this.props.compData.emailFieldLabel]),this.props.metaSiteId,this.state.message&&this.state.message.value,this.state.phone&&this.state.phone.value,this.state.subject&&this.state.subject.value,this.state.address&&this.state.address.value);if(!g.isOpen("sendContactFormEmailsViaPong")){c.htmlMessage=p.call(this,a,this.props.externalBaseUrl||"",b);return c}c.fields=a;return c}var r="/_api/wix-common-services-webapp/notification/invoke";var s="https://fallback.wix.com";var t="/_api/crm-inbox-server/pong/message";function u(a){var b=g.isOpen("sendContactFormEmailsViaPong")?t:r;if(!a){var c=window.location.protocol+"//"+window.location.hostname;var e=k.getCookie(n);var f="Secured";var h="{{site}}{{service}}{{secured}}?accept=json&contentType=json&appUrl={{site}}{{cookie}}";return h.replace(/\{\{site\}\}/g,c).replace("{{service}}",b).replace("{{cookie}}",e).replace("{{secured}}",f)}var i=d.urlUtils.parseUrl(a);var j=i.protocol+"//"+i.host+b+"?accept=json&contentType=json&appUrl="+i.protocol+"//"+i.hostname;return j}function v(){var a=s+r+"?accept=json&contentType=json&appUrl="+s;return a}function w(a,b,d,e){var f=c.activityTypes[a];if(f){c.activityService.reportActivity(new f(d,b,e))}}function x(a){return a.ignoreActivityReport||a.isTemplate}function y(){var a=this.props.compData.successMessage||this.translatedKeys.successMessage;this.showMessage(a)}function z(){var b=this.props.compData.link;if(!b){return}var c=d.linkRenderer.renderLink(b,this.props.linkRenderInfo,this.props.rootNavigationInfo);var e=d.wixUrlParser.parseUrl(this.props.linkRenderInfo,d.linkRenderer.getLinkUrlFromLinkProps(c));if(!e){return}var f=b.anchorDataId;a.assign(e,{anchorData:f});if(e.pageId===this.props.rootNavigationInfo.pageId){if(f){this.props.scrollToAnchor(f)}}else{this.props.navigateToPage(e)}}function A(a){this.props.reportBI(f.FORM_SUBMIT_SUCCESS,{componentId:this.props.id,componentType:this.props.structure.componentType});this.setState({mailSent:true});if(this.props.compData.onSubmitBehavior==="message"){y.call(this)}else{z.call(this)}if(!x(this.props)){w(a,this.getFieldsForActivityReporting(),this.props.activityInfo,this.getFieldLabels())}D.call(this,this.getFormInputs());this.isBusy=false}var B=["abort","timeout"];function C(b,c){if(this.shouldSubmitFallbackRequest&&a.includes(B,c)){this.props.reportBI(e.FORM_SUBMIT_FAILURE,{componentId:this.props.id,componentType:this.props.structure.componentType,errorDesc:"Unspecified error occurred, possibly a connection problem, fallback activated",response:b});G.call(this)}else{this.props.reportBI(e.FORM_SUBMIT_FINAL_FALLBACK,{componentId:this.props.id,componentType:this.props.structure.componentType,errorDesc:"Error occurred in Fallback Request",response:b});this.setState({mailSent:false});this.showMessage(this.translatedKeys.error,true);this.isBusy=false}}function D(b){var c=a.reduce(b,function(a,b){var c=b.skinPart||b;a[c]=this.state[c];a[c].value="";return a}.bind(this),{});this.setState(c)}function E(){if(g.isOpen("longer_timeouts_pong")){return 3e4}return 8e3}function F(){if(this.shouldBlockSubmit&&this.shouldBlockSubmit()){this.blockSubmit(h.findDOMNode(this));return}var a=this.props.compData.toEmailAddress;var b=a&&a!=="a33012eff368a577d48f52f310c92140";if(!b){this.props.reportBI(e.FORM_SUBMIT_INVALID_EMAIL,{email:a})}var c=!this.isBusy&&this.isFormValid();if(c){this.shouldSubmitFallbackRequest=true;this.isBusy=true;var d=this.props.compData.onSubmitBehavior;if(d==="message"){this.showMessage(this.translatedKeys.submitting)}this.props.reportBI(f.FORM_SUBMIT,{componentId:this.props.id,componentType:this.props.structure.componentType});var g=q.call(this);m.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:u(this.props.externalBaseUrl||""),data:JSON.stringify(g),success:A.bind(this,this.getActivityName()),error:C.bind(this),timeout:E()})}}function G(){this.shouldSubmitFallbackRequest=false;var a=q.call(this);m.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:v(),data:JSON.stringify(a),success:A.bind(this,this.getActivityName()),error:C.bind(this)})}function H(a,b){return d.wixUserApi.getLanguage(a,b).toLowerCase()||"en"}return{mixins:[j.skinBasedComp,j.timeoutsMixin],propTypes:{id:b.Types.Component.id.isRequired,structure:b.Types.Component.structure.isRequired,compData:b.Types.Component.compData.isRequired,rootNavigationInfo:b.Types.Component.rootNavigationInfo.isRequired,shouldResetComponent:b.Types.RenderFlags.shouldResetComponent.isRequired,cookie:b.Types.RequestModel.cookie.isRequired,currentUrl:b.Types.currentUrl.isRequired,isMobileView:b.Types.isMobileView.isRequired,isPremiumUser:b.Types.isPremiumUser.isRequired,isTemplate:b.Types.isTemplate.isRequired,metaSiteId:b.Types.RendererModel.metaSiteId.isRequired,externalBaseUrl:b.Types.PublicModel.externalBaseUrl,scrollToAnchor:b.Types.scrollToAnchor.isRequired,navigateToPage:b.Types.navigateToPage.isRequired,reportBI:b.Types.reportBI.isRequired,linkRenderInfo:b.Types.Link.linkRenderInfo.isRequired,activityInfo:b.Types.Activity.activityInfo,ignoreActivityReport:i.PropTypes.bool},getInitialState:function(){this.shouldResetFields=this.props.shouldResetComponent;this.translatedKeys=this.getLangKeys(H(this.props.cookie,this.props.currentUrl));this.translatedKeys.submitting="â€¦";return a.merge(this.getFormInitialState(),{$mob:this.props.isMobileView?"mobile":"desktop",$dir:this.props.compData.textDirection||"left"})},showMessage:function(a,b){this.setState({notifications:{message:a,error:!!b}})},componentWillReceiveProps:function(a){var b=this.props.shouldResetComponent;if(b&&b!==this.shouldResetFields){D.call(this,this.getFormInputs())}this.shouldResetFields=b;this.setState({$mob:a.isMobileView?"mobile":"desktop",$dir:a.compData.textDirection||"left"})},getSkinProperties:function(){if(this.state.notifications.message){this.registerReLayout()}return a.merge(this.getFormSkinProperties(this.translatedKeys),{"":{style:{height:"inherit"}},submit:{onClick:F.bind(this),children:this.props.compData.submitButtonLabel||"Send"}})}}});define("formCommon",["formCommon/mixins/formMixin"],function(a){"use strict";return{formMixin:a}});
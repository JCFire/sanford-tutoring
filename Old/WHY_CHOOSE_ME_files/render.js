define("render",["lodash","coreUtils","utils","core","reactDOM"],function(a,b,c,d,e){"use strict";var f=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date);function g(a,b){var c=b.query;var d=c.configName||"fullFunctionality";var e=a[d]||a.fullFunctionality;var f=e.getConfig();if(!c.dsOrigin){throw new Error("You must define dsOrigin parameter in order to use the documentServices - please speak to html-server team for a key")}f.origin=c.dsOrigin;return f}function h(b,d,e){var f=a(e).keys().pull("masterPage").value();return a.mapValues(e,function(a,e){if(d&&window.pagesData&&window.pagesData[e]){return a}return c.dataFixer.fix(a,f.slice(),b.requestModel,b.currentUrl,b.urlFormatModel,b.viewMode==="site",b.rendererModel.clientSpecMap)})}function i(b,c,g,h,i){d.renderer.renderSite(c,g,h,function(c){if(window.rendered){window.rendered.forceUpdate()}else{var d=window.document.getElementById("SITE_CONTAINER").children[0];window.rendered=e.render(c,window.document.getElementById("SITE_CONTAINER"));var g=window.document.getElementById("SITE_CONTAINER").children[0];if(window.sssr){window.sssr.success=d===g;window.sssr.clientSideRender={sinceInitialTimestamp:Date.now()-window.wixBiSession.initialTimestamp,performanceNow:f()};require(["warmup"],function(a){if(window.sssr.success){a.postClientRenderOperations()}a.indicator.updateState(window.sssr.success?a.indicator.STATES.SUCCESS:a.indicator.STATES.FAIL)})}window.onpopstate=window.rendered.onPopState;window.onhashchange=window.rendered.onHashChange;if(window.parent){window.rendered.registerAspectToEvent("siteReady",function(){if(i){i(window.rendered)}if(window.documentServices){window.parent.postMessage("documentServicesLoaded","*")}})}if(b.qaAutomation){a.set(window,"testApi.domSelectors",b.qaAutomation.getDomSelectors(b.react,b.reactDOM));window.testApi.domSelectors.setSearchRoot(window.rendered);a.set(window,"testApi.isReady",true)}}})}function j(c,e,f){var g={};if(b.urlUtils.isQueryParamOn(f.currentUrl,"isSantaEditor")){g=a.assign(g,{componentViewMode:"editor"})}if(f.rendererModel.previewMode){g=a.assign(g,{isSocialInteractionAllowed:false,isPlayingAllowed:false})}f.renderFlags=a.assign({},f.renderFlags,g);var h=new d.SiteData(f);var i=d.SiteDataAPI.createSiteDataAPIAndDal(h,e);var j=i.siteData;var k=i.siteDataAPI;var l={pointers:i.pointers,displayedDAL:i.displayedDal,siteDataAPI:k};var m=false;return{fullSiteData:h,displayedSiteData:j,siteDataWrapper:i,viewerPrivateServices:l,isServerSideRender:m,siteModel:f,siteDataAPI:k}}function k(b,d,e,f,k){var l=j(b,d,e);var m=b.documentServices;try{if(m&&a.isUndefined(window.karmaIntegration)&&window.parent.FS){c.integrations.fullStory.start()}}catch(a){}if(m){l.siteDataWrapper.dataLoadedRegistrar=l.siteDataAPI.registerDataLoadedCallback.bind(l.siteDataAPI);window.documentServices=new m.Site(g(m.configs,l.siteModel.currentUrl),l.siteDataWrapper,a.partial(h,l.siteModel,l.isServerSideRender),a.partial(i,b,l.displayedSiteData,l.viewerPrivateServices,f));a.set(window,"testApi.documentServices",window.documentServices)}else{var n=l.fullSiteData.pagesData;l.fullSiteData.pagesData=n&&h(l.siteModel,l.isServerSideRender,n);if(n.masterPage){l.siteDataAPI.createDisplayedPage("masterPage")}i(b,l.displayedSiteData,l.viewerPrivateServices,f,k)}}return{clientSide:k}});
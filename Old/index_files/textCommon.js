define("textCommon/utils/filterHtmlString",["lodash","xss","experiment"],function(a,b,c){"use strict";if(!b){return a.identity}var d=["style","class","dir","wix-comp"];var e={iframe:["frameborder","height","width","src","marginheight","marginwidth","name","scrolling","longdesc"].concat(d)};function f(){var c={strike:[],hatul:[],wline:[]};var e=["color","background-color","font-size","font-family","font-style","text-decoration","line-height","text-shadow","direction","position","z-index","top","left"];a.assign(b.whiteList,c);b.whiteList.a.push("data-anchor");b.whiteList.a.push("dataquery");b.whiteList.a.push("data-content");b.whiteList.a.push("data-no-physical-url");b.whiteList.a.push("data-type");b.whiteList.a.push("id");a.forOwn(b.whiteList,function a(b){b.push.apply(b,d)});a.forEach(e,function a(c){b.cssFilter.options.whiteList[c]=true})}f();function g(a){return/^tel:[^A-Za-z]+$/i.test(a)}function h(a,d,e,f){if(c.isOpen("sv_textLinkWhiteList")){if(g(e)){return e}}return b.safeAttrValue(a,d,e,f)}return function c(d,f){if(f){a.assign(b.whiteList,e)}else{delete b.whiteList.iframe}var g=b(d,{stripIgnoreTagBody:true,safeAttrValue:function a(b,c,d,e){var f=h(b,c,d,e);if(f){return f}return""}});return g}});define("textCommon/mixins/textCompMixin",["lodash","react","core","santaProps","textCommon/utils/filterHtmlString"],function(a,b,c,d,e){"use strict";return{propTypes:{reportBI:d.Types.reportBI,id:d.Types.Component.id.isRequired,skin:d.Types.Component.skin.isRequired,style:d.Types.Component.style.isRequired,structure:d.Types.Component.structure.isRequired,title:b.PropTypes.string},mixins:[c.compMixins.skinBasedComp],componentWillMount:function(){this.updateHTML(this.props)},updateHTML:function(a){this._componentHtml=e(a.compData.text||"",this.allowIframes);this.convertCompDataTextToHTML(a)},componentWillReceiveProps:function(a){this.updateHTML(a)},getRootStyle:function(b){var c=a.clone(b||{});if((c["overflow-y"]||c.overflowY)!=="hidden"){c.height="auto"}return c},getSkinProperties:function(){this.lastScale=a.get(this,"props.structure.layout.scale")||1;var b=this.props.skin;var c={"":{style:this.getRootStyle(this.props.style)}};var d;if(b==="wysiwyg.viewer.skins.WRichTextSkin"||b==="wysiwyg.viewer.skins.WRichTextClickableSkin"){d=c.richTextContainer={}}else{d=c[""]}if(a.isString(this._componentHtml)){d.dangerouslySetInnerHTML={__html:this._componentHtml||""}}else{d.children=this._componentHtml}if(this.props.title){c[""].title=this.props.title}var e=a.get(this.props,["compProp","overrideAlignment"]);if(e){d.className=this.classSet(a.zipObject(["override-"+e],[true]))}return c}}});define("textCommon/mixins/textScaleMixin",["lodash","skins","fonts","santaProps","siteUtils","core"],function(a,b,c,d,e,f){"use strict";var g=c.fontUtils;function h(a,b){return e.mobileUtils.convertFontSizeToMobile(a,b)}function i(){var c=b.skins[this.props.skin]&&b.skins[this.props.skin].exports;var d=a.find(c,function(b){var c=b.skin;return!a.isUndefined(this.getParamFromSkin("fnt",c).value)}.bind(this));return d&&this.getParamFromSkin("fnt",d.skin).value}function j(b){return a.get(b,["structure","layout","scale"])||1}return{mixins:[f.compMixins.skinInfo],propTypes:{structure:d.Types.Component.structure,compTheme:d.Types.Component.theme,skin:d.Types.Component.skin,isMobileView:d.Types.isMobileView,fontsMap:d.Types.Fonts.fontsMap},componentWillMount:function(){this.lastScale=j(this.props)},componentWillReceiveProps:function(){this.lastScale=j(this.props)},fontGetter:function(a){var b=a.split("_")[1];return this.props.fontsMap[b]},getFontSize:function(a,b){var c={};if(this.props.isMobileView){var d=this.getDesktopFontSize(a);if(d){var e=b||this.props.structure.layout.scale;c.fontSize=h(d,e)+"px"}}return c},getDesktopFontSize:function(c){var d=this.props.compTheme;var e=c||"fnt";var f=a.get(d,["style","properties",e])||a.get(b,["skins",this.props.skin,"paramsDefaults",e])||i.call(this);if(f){var h=this.fontGetter(f)||f;return parseInt(g.parseFontStr(h).size,10)}}}});define("textCommon/mixins/baseTextInput",["lodash","react","santaProps","core"],function(a,b,c,d){"use strict";var e=d.compMixins;var f={style:{display:"none"}};function g(a){return{$label:a.compProp.label?"hasLabel":"noLabel"}}function h(){var b=this.props.compProp;var c=this.props.compData;var d={type:c.textType,name:c.name||this.props.structure.nickname,value:this.state.value,onChange:this._handleChange,onBlur:this._handleBlur,onFocus:this._handleFocus,onClick:this._handleClick,onKeyUp:this._handleKeyUp,disabled:b.isDisabled,required:b.required,readOnly:b.readOnly,placeholder:b.placeholder,tabIndex:b.tabIndex};if(d.type==="number"){a.assign(d,{min:c.min,max:c.max})}if(c.pattern){a.assign(d,{pattern:c.pattern})}if(c.maxLength){a.assign(d,{maxLength:c.maxLength})}if(b.autoComplete&&d.type!=="password"){d.autoComplete="on"}return d}var i=function(b){var c=a.get(this,"refs.input");return{valid:a.get(b,"valid",true),validity:a.get(c,"validity",{}),validationMessage:a.get(c,"validationMessage","")}};var j={mixins:[e.skinBasedComp,e.runTimeCompData,e.compStateMixin(i)],propTypes:{compData:c.Types.Component.compData.isRequired,compProp:c.Types.Component.compProp.isRequired,structure:c.Types.Component.structure.isRequired,shouldResetComponent:c.Types.RenderFlags.shouldResetComponent,isValid:b.PropTypes.bool,isPreset:b.PropTypes.bool,onChange:b.PropTypes.func,message:b.PropTypes.string},BASE_TEXT_BEHAVIORS:{change:{methodName:"setValidateState"},setCustomValidity:{methodName:"setCustomValidity",params:["customValidity"]}},getInitialState:function(){return a.assign(g(this.props),{customValidity:"",valid:!(this.props.isValid===false),value:this.props.compData.value})},componentWillReceiveProps:function(b){var c=g(b);if(a.has(b.compData,"value")&&b.compData.value!==this.state.value){c.value=b.compData.value}if(b.shouldResetComponent!==this.props.shouldResetComponent){c.customValidity=""}this.setState(c)},componentDidUpdate:function(a,b){if(b.customValidity!==this.state.customValidity){this.refs.input.setCustomValidity(this.state.customValidity)}},_handleClick:function(a){if(this.props.isPreset){a.target.select()}},setValidateState:function(){this.setState({valid:!!(this.validate()==="valid")})},setCustomValidity:function(a){this.setState({customValidity:a})},validate:function(){var a=this.refs.input;var b=this.props.compProp.required?this.state.value.length===0:false;this.handleAction("validate");return!b&&a.validity&&a.validity.valid?"valid":"invalid"},_handleChange:function(a){var b=a.target.value;if(b===this.state.value){return}this.setState({value:b},function(){this.updateData({value:b})}.bind(this));this.latestChangeEvent=a},_handleBlur:function(a){if(this.props.onChange){this.props.onChange(a)}this.handleAction("blur",a);if(this.latestChangeEvent){this.handleAction("change",this.latestChangeEvent);this.setValidateState();this.latestChangeEvent=null}},_handleFocus:function(a){this.handleAction("focus",a)},_handleKeyUp:function(a){this.handleAction("keyPress",a)},getBaseTextInputSkinProperties:function(){var a=this.props.compProp;return{label:a.label?{children:a.label}:f,input:h.call(this),message:this.props.message?{children:this.props.message,style:{whiteSpace:"normal"}}:f}}};return j});define("textCommon/utils/textTransforms",["lodash","siteUtils","coreUtils","color"],function(a,b,c,d){"use strict";var e=c.cssUtils;var f=c.fragment;if(typeof window!=="undefined"){window.addEventListener("message",function(b){if(b.data==="show-always"){window.showAlways=!window.showAlways;a.forEach(window.document.getElementsByClassName("text-info-n47t"),function(a){if(window.showAlways){a.classList.add("show-always")}else{a.classList.remove("show-always")}})}})}function g(a,b){var c=a.hexString()!=="#000000"?a.clone():new d("#121212");c.lightness(c.hslArray()[2]*(b||1));return c}function h(a){var b=parseFloat(a);if(!isNaN(b)){return b}}function i(b){if(!b){return}return a.head(b.split(","))}function j(a){if(!a){return}return new d(e.normalizeColorStr(a))}function k(a,b,c){var d=a.getAttribute("style")||"";var e=d.replace(new RegExp("[^;]s*"+b+"s*:s*(.*?)s*[;$]"),"")+(d!==""&&d[d.length-1]!==";"?";":"")+b+":"+c;a.setAttribute("style",e)}function l(a,c,d){if(!c.fontSize){return}if(c.fontSize%1!==0){return}if(!a.style.fontSize&&!o(a,d)){return}var e=parseFloat(d.scale);var f=Math.round(b.mobileUtils.convertFontSizeToMobile(c.fontSize,e));k(a,"font-size",f+"px")}function m(a,b,c){if(!b.color){return}var d=o(a,c);if(!a.style.color&&!r(a,d,c)){return}var e=parseFloat(c.brightness);var f=g(b.color,e);k(a,"color",f.rgbaString())}function n(a,b,c){var d=o(a,c);if(a.style.color||r(a,d,c)){var e=c.overrideColor.replace(/(^\d+,\d+,\d+,\d+$)/,"rgba($1)");k(a,"color",e)}}function o(a,b){var c=/(?:\s|^)(font_\d+)(?:\s|$)/g.exec(a.className);if(!c){return}var d=b.fontGetter&&b.fontGetter(c[1]);if(d){return e.parseFontStr(d)}}function p(a){var b=/(?:\s|^)(color_\d+)(?:\s|$)/g.exec(a.className);if(b){return b[1]}}function q(b){var c=/^{(color_\d+)}$/.exec(a.get(b,"color"));if(c){return c[1]}}function r(a,b,c){var d=p(a)||q(b);if(!d){return}var e=c.colorGetter&&c.colorGetter(d);if(e){return e}}function s(b,c){var d=o(b,c);var e=r(b,d,c);return{fontSize:h(a.get(d,"size")),fontName:i(a.get(d,"family")),color:j(e)}}function t(b){var c=a(b.style).pick(["fontSize","fontFamily","color"]).omitBy(a.isEmpty).value();return{fontSize:h(c.fontSize),fontName:i(c.fontFamily),color:j(c.color)}}function u(b,c,d,e){var f=a.defaults({},t(b),s(b,e),c);a.forEach(b.children,a.partial(u,a,f,d,e));a.invokeMap(d,"call",null,b,f)}function v(a,b,c){var d={characterCount:a.textContent.length};u(a,d,b,c)}function w(b){var c=[];if(b.overrideColor){c.push(a.partial(n,a,a,b))}else if(b.brightness&&parseFloat(b.brightness)!==1){c.push(a.partial(m,a,a,b))}if(b.scale){c.push(a.partial(l,a,a,b))}return c}function x(){var a=f.document.createDocumentFragment();return a.appendChild(f.document.createElement("div"))}return{applyMobileAdjustments:function(b,c){var d=w(c);if(d.length===0){return b}var e=x();e.innerHTML=b;a.forEach(e.children,a.partial(v,a,d,c));return e.innerHTML}}});define("textCommon/utils/textComponentsUtils",["lodash","coreUtils","textCommon/utils/textTransforms","experiment","textCommon/utils/filterHtmlString"],function(a,b,c,d,e){"use strict";var f=b.anchorTagsGenerator;function g(b,c,f,g,h){var i=a.transform(c,function(a,b){a["#"+b.id]=b},{});return b.replace(/<a ([^>]*)dataquery="([^"]+)"([^>]*)>/g,function(b,c,j,k){var l=g?f(i[j],g,h):f(i[j]);if(d.isOpen("sv_textLinkWhiteList")){return e("<a "+c+a.map(l,function(a,b){return b+'="'+a+'"'}).join(" ")+k+">")}return"<a "+c+a.map(l,function(a,b){return b+'="'+a+'"'}).join(" ")+k+">"})}function h(a,b){if(!b.isMobileView){return a}a=c.applyMobileAdjustments(a,b);return a}function i(a){var b=f.getIncludedPatterns(d,a.isMobileView);return f.generateAnchorsInHtml(a.htmlContent,b)}return{convertDataQueryLinksIntoHtmlAnchors:g,mobileTextTransformIfNeeded:h,createImpliedLinks:i}});define("textCommon",["textCommon/mixins/textCompMixin","textCommon/mixins/textScaleMixin","textCommon/mixins/baseTextInput","textCommon/utils/textComponentsUtils"],function(a,b,c,d){"use strict";return{textCompMixin:a,textScaleMixin:b,textComponentsUtils:d,baseTextInput:c}});